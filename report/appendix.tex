% the first version of this file was generatd with
% http://superuser.com/questions/601198/how-can-i-automatically-convert-all-source-code-files-in-a-folder-recursively


\documentclass{article}
\usepackage{listings}
\usepackage[usenames,dvipsnames]{color}  %% Allow color names

%\usepackage[toc,page]{appendix}
\usepackage[left=1in, right=1in, top=1in, bottom=1in]{geometry}

% Scala syntax highlighting taken from https://gist.github.com/Blaisorblade/1722948

\newcommand{\code}[1]{../%
    \lstinline[%keywordstyle=,%
        flexiblecolumns=true,%
basicstyle=\ttfamily]£#1£}

\lstdefinelanguage{scala}{
    morekeywords={%
        abstract,case,catch,class,def,do,else,extends,%
        false,final,finally,for,forSome,if,implicit,import,lazy,%
        match,new,null,object,override,package,private,protected,%
        return,sealed,super,this,throw,trait,true,try,type,%
    val,var,while,with,yield},
    otherkeywords={=>,<-,<\%,<:,>:,\#,@},
        sensitive=true,
        morecomment=[l]{//},
        morecomment=[n]{/*}{*/},
        morestring=[b]",
        morestring=[b]',
        morestring=[b]"""
    }[keywords,comments,strings]

    % activate the language and predefine settings
    \lstset{language=Scala}

    \lstset{
        language=Scala,%
        xleftmargin=4mm,%
        aboveskip=3mm,%
        belowskip=3mm,%
        fontadjust=true,%
        columns=[c]fixed,%
        keepspaces=true,%
        basewidth={0.58em, 0.53em},%
        tabsize=2,%
        basicstyle=\renewcommand{\baselinestretch}{0.95}\ttfamily,%
        commentstyle=\itshape,%
        keywordstyle=\bfseries,%
        mathescape=true,%
        escapechar=¤,%
        captionpos=b,%
        framerule=0.3pt,%
        firstnumber=0,%
        numbersep=1.5mm,%
        numberstyle=\tiny,%
    }

    \lstdefinestyle{floating}{%
        xleftmargin=10pt,%
        xrightmargin=5pt,%
        aboveskip=4mm,%
        belowskip=4mm,%
        fontadjust=true,%
        columns=[c]flexible,%
        keepspaces=true,%
        basewidth={0.5em, 0.425em},%
        tabsize=2,%
        basicstyle=\renewcommand{\baselinestretch}{0.95}\ttfamily,%
        commentstyle=\rm,%
        keywordstyle=\bfseries,%
        mathescape=true,%
        captionpos=b,%
        framerule=0.3pt,%
        firstnumber=0,%
        numbersep=1.5mm,%
        numberstyle=\tiny,%
        float=tbp,%
        frame=tblr,%
        framesep=5pt,%
        framexleftmargin=3pt,%
        abovecaptionskip=\smallskipamount,%
        belowcaptionskip=\smallskipamount,%
    } % to define: caption, label

    \definecolor{darkgreen}{rgb}{0.0, 0.2, 0.13}

    \lstdefinestyle{customasm}{
        belowcaptionskip=1\baselineskip,
        xleftmargin=\parindent,
        %  language=C++,   %% Change this to whatever you write in
        breaklines=true, %% Wrap long lines
        basicstyle=\footnotesize\ttfamily,
        commentstyle=\itshape\color{Gray},
        stringstyle=\color{darkgreen},
        keywordstyle=\bfseries\color{blue},
        identifierstyle=\color{black},
        %xleftmargin=-8em,
        showstringspaces=false,
    }        
    \usepackage[colorlinks=true,linkcolor=blue]{hyperref} 
    \begin{document}
    \tableofcontents

%    \begin{appendices}

    \section{Compilation Stages}
    \subsection{01\_parser.scala}
    \lstinputlisting[style=customasm]{../01_parser.scala}
    \newpage
    \subsection{02\_expand\_let\_ns.scala}
    \lstinputlisting[style=customasm]{../02_expand_let_ns.scala}
    \newpage
    \subsection{03\_reduce\_prim\_ops.scala}
    \lstinputlisting[style=customasm]{../03_reduce_prim_ops.scala}
    \newpage
    \subsection{04\_wrap\_funcs\_in\_lambdas.scala}
    \lstinputlisting[style=customasm]{../04_wrap_funcs_in_lambdas.scala}
    \newpage
    \subsection{05\_cps\_translation.scala}
    \lstinputlisting[style=customasm]{../05_cps_translation.scala}
    \newpage
    \subsection{06\_closure\_conversion.scala}
    \lstinputlisting[style=customasm]{../06_closure_conversion.scala}
    \newpage
    \subsection{07\_hoisting.scala}
    \lstinputlisting[style=customasm]{../07_hoisting.scala}
    \newpage
    \subsection{08\_ir\_conversion.scala}
    \lstinputlisting[style=customasm]{../08_ir_conversion.scala}
    \newpage
    \subsection{09\_remove\_redundant\_assigns.scala}
    \lstinputlisting[style=customasm]{../09_remove_redundant_assigns.scala}
    \newpage
    \subsection{10a\_asmjs\_conversion.scala}
    \lstinputlisting[style=customasm]{../10a_asmjs_conversion.scala}
    \newpage
    \subsection{10b\_c\_conversion.scala}
    \lstinputlisting[style=customasm]{../10b_c_conversion.scala}
    \newpage
    \subsection{11ba\_em\_c\_conversion.scala}
    \lstinputlisting[style=customasm]{../11ba_em_c_conversion.scala}
    \newpage
    \subsection{11bb\_llvm\_ir\_conversion.scala}
    \lstinputlisting[style=customasm]{../11bb_llvm_ir_conversion.scala}
    \newpage
    \subsection{12bb\_numbered\_llvm\_ir\_conversion.scala}
    \lstinputlisting[style=customasm]{../12bb_numbered_llvm_ir_conversion.scala}
    \newpage

    \section{Code Generation}
    \subsection{code\_generation\_asmjs.scala}
    \lstinputlisting[style=customasm]{../code_generation_asmjs.scala}
    \newpage
    \subsection{code\_generation\_c.scala}
    \lstinputlisting[style=customasm]{../code_generation_c.scala}
    \newpage
    \subsection{code\_generation\_ir.scala}
    \lstinputlisting[style=customasm]{../code_generation_ir.scala}
    \newpage
    \subsection{code\_generation\_ljsp.scala}
    \lstinputlisting[style=customasm]{../code_generation_ljsp.scala}
    \newpage
    \subsection{code\_generation\_llvm\_ir.scala}
    \lstinputlisting[style=customasm]{../code_generation_llvm_ir.scala}
    \newpage

    \section{The Ray Tracer}
    \subsection{ray\_tracer/handwritten\_asm.js}
    \lstinputlisting[style=customasm, keywords={}]{../ray_tracer/handwritten_asm.js}
    \newpage
    \subsection{ray\_tracer/ljsp\_code.scm}
    \lstinputlisting[style=customasm, language=Lisp]{../ray_tracer/ljsp_code.scm}
    \newpage
    \subsection{ray\_tracer/ray\_tracer.html}
    \lstinputlisting[style=customasm, keywords={}]{../ray_tracer/ray_tracer.html}
    \newpage
    \subsection{ray\_tracer/ray\_tracer.js}
    \lstinputlisting[style=customasm, keywords={}]{../ray_tracer/ray_tracer.js}
    \newpage

    \section{Testing}
    \subsection{run\_tests.py}
    \lstinputlisting[style=customasm, keywords={}]{../run_tests.py}
    \newpage
    \subsection{test/test\_cases/apply.scm}
    \lstinputlisting[style=customasm, language=Lisp]{../test/test_cases/apply.scm}
    \subsection{test/test\_cases/fac-test-1.scm}
    \lstinputlisting[style=customasm, language=Lisp]{../test/test_cases/fac-test-1.scm}
    \subsection{test/test\_cases/fac-test-2.scm}
    \lstinputlisting[style=customasm, language=Lisp]{../test/test_cases/fac-test-2.scm}
    \subsection{test/test\_cases/identity-appl.scm}
    \lstinputlisting[style=customasm, language=Lisp]{../test/test_cases/identity-appl.scm}
    \subsection{test/test\_cases/lambda-param.scm}
    \lstinputlisting[style=customasm, language=Lisp]{../test/test_cases/lambda-param.scm}
    \subsection{test/test\_cases/let-test-1.scm}
    \lstinputlisting[style=customasm, language=Lisp]{../test/test_cases/let-test-1.scm}
    \subsection{test/test\_cases/let-test-2.scm}
    \lstinputlisting[style=customasm, language=Lisp]{../test/test_cases/let-test-2.scm}
    \subsection{test/test\_cases/prim-ops-1.scm}
    \lstinputlisting[style=customasm, language=Lisp]{../test/test_cases/prim-ops-1.scm}
    \subsection{test/test\_cases/prim-ops-2.scm}
    \lstinputlisting[style=customasm, language=Lisp]{../test/test_cases/prim-ops-2.scm}
    \subsection{test/test\_cases/prim-ops-3.scm}
    \lstinputlisting[style=customasm, language=Lisp]{../test/test_cases/prim-ops-3.scm}
    \subsection{test/test\_cases/static-return.scm}
    \lstinputlisting[style=customasm, language=Lisp]{../test/test_cases/static-return.scm}
    \subsection{test/test\_cases/static-value.scm}
    \lstinputlisting[style=customasm, language=Lisp]{../test/test_cases/static-value.scm}
    \subsection{test/test\_cases/two-types-of-fvar.scm}
    \lstinputlisting[style=customasm, language=Lisp]{../test/test_cases/two-types-of-fvar.scm}
    \newpage
    \subsection{test/test\_lib.scm}
    \lstinputlisting[style=customasm, language=Lisp]{../test/test_lib.scm}
    \newpage
        
    \section{Other Files}
    \subsection{AST.scala}
    \lstinputlisting[style=customasm]{../AST.scala}
    \newpage
    \subsection{util.scala}
    \lstinputlisting[style=customasm]{../util.scala}
    \newpage
    \subsection{jalloc.c}
    \lstinputlisting[style=customasm, language=C]{../jalloc.c}
    \newpage
    \subsection{main.scala}
    \lstinputlisting[style=customasm]{../main.scala}
    \newpage

%    \end{appendices}

\end{document}
